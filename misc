
/*

SELECT  
CalendarWeekStart, 
CalendarWeekEnd,  
CalendarMonthStart,
CalendarMonthEnd,		
FiscalQuarterStart,			
FiscalQuarterEnd,	
Calendaryyyymmm,	
Fiscalyyyyq,
Fiscalyyyy,
CalendarWeeksFromCurrent,
CalendarMonthsFromCurrent,
FiscalQuartersfromCurrent, 
LastExtract,
Application,
Breakdown,
Level1,
Level2,
---------------------CalendarDate, 
CampaignName, 
CampaignId, 
AdsetName, 
AdsetId, 
AdsetStatus, 
AdName, 
AdId, 
Objective, 
CustomEventType,
sum(Impressions) as Impressions, 
sum(Reach) as Reach, 
sum(Clicks) as Clicks,
sum(UniqueClicks) as UniqueClicks,
sum(InlineLinkClicks) as InlineLinkClicks,
sum(UniqueInlineLinkClicks) as UniqueInlineLinkClicks,
Sum(InlinePostEngagement) as InlinePostEngagement,
Sum(Spend) as Spend,
Sum(SocialSpend) as SocialSpend,
-----s.daily_budget as DailyBudget, 
-----s.lifetime_budget as LifetimeBudget, 
-----s.budget_remaining as BudgetRemaining,
/* these are all caluclated metrics
safe_divide(impressions,reach) as frequency1,
frequency, 
safe_divide(clicks,impressions)*100 as ctr1,
ctr,
safe_divide(unique_clicks,reach)*100 as u_ctr1,
unique_ctr, 
safe_divide(inline_link_clicks,impressions)*100 as in_link_ctr, 
inline_link_click_ctr,
------safe_divide(inline_link_clicks,reach)*100 as u_in_link_ctr,
unique_inline_link_click_ctr, 
safe_divide(unique_inline_link_clicks,reach)*100 as u_in_link_ctr1,
unique_inline_link_click_ctr, 
-----unique_link_clicks_ctr, 
safe_divide(inline_post_engagement,impressions)*100 as inpost_ctr,
*//*
Sum(ActionsComment) as ActionsComment,
Sum(ActionsCompleteRegistration) as ActionsCompleteRegistration, 
Sum(ActionsLandingPageView) as ActionsLandingPageView, 
Sum(ActionsLead) as ActionsLead, 
Sum(ActionsLike) as ActionsLike, 
Sum(ActionsLinkClick) as ActionsLinkClick, 
Sum(ActionsOutboundClick) as ActionsOutboundClick, 
Sum(ActionsOffsiteConversionCustom) as ActionsOffsiteConversionCustom, 
Sum(ActionsPageEngagement) as ActionsPageEngagement, 
Sum(ActionsPost) as ActionsPost, 
Sum(ActionsPostEngagement) as ActionsPostEngagement, 
Sum(ActionsPostReaction) as ActionsPostReaction,
Sum(ActionsPostSave) as ActionsPostSave,  
Sum(ActionsViewContent) as ActionsViewContent, 
Sum(ActionsVideoView) as ActionsVideoView, 
Sum(UniqueActionsVideoView) as UniqueActionsVideoView, 
Sum(ActionsVideoWatched_30sec) as ActionsVideoWatched_30sec,
Sum(ActionsVideoWatched_p25) as ActionsVideoWatched_p25,
Sum(ActionsVideoWatched_p50) as ActionsVideoWatched_p50,
Sum(ActionsVideoWatched_p75) as ActionsVideoWatched_p75,
Sum(ActionsVideoWatched_p100) as ActionsVideoWatched_p100,
   
from `crowdriff-revops`.`bi_business`.`ad_analytics_daily`

  Group by 
  CalendarWeekStart, 
CalendarWeekEnd,  
CalendarMonthStart,
CalendarMonthEnd,		
FiscalQuarterStart,			
FiscalQuarterEnd,	
Calendaryyyymmm,	
Fiscalyyyyq,
Fiscalyyyy,
CalendarWeeksFromCurrent,
CalendarMonthsFromCurrent,
FiscalQuartersfromCurrent, 
LastExtract,
Application,
Breakdown,
Level1,
Level2,
---------------------CalendarDate, 
CampaignName, 
CampaignId, 
AdsetName, 
AdsetId, 
AdsetStatus, 
AdName, 
AdId, 
Objective, 
CustomEventType
Order by Application, Breakdown,
CalendarWeekEnd,Level2,Level1;

--------------------Monthly

SELECT  
-------CalendarWeekStart, 
--------CalendarWeekEnd,  
CalendarMonthStart,
CalendarMonthEnd,		
--------------FiscalQuarterStart,			
-------FiscalQuarterEnd,	
--------Calendaryyyymmm,	
---------Replace(Fiscalyyyyq,'_',' ') as Fiscalyyyyq,
--------Fiscalyyyy,
------CalendarWeeksFromCurrent,
------------CalendarMonthsFromCurrent,
--------------------FiscalQuartersfromCurrent, 
Latest_FB_Day,
Breakdown,
Level1,
Level2,
---------------------CalendarDate, 
CampaignName, 
CampaignId, 
AdsetName, 
AdsetId, 
AdsetStatus, 
AdName, 
AdId, 
Objective, 
CustomEventType,
sum(Impressions) as Impressions, 
sum(Reach) as Reach, 
sum(Clicks) as Clicks,
sum(UniqueClicks) as UniqueClicks,
sum(InlineLinkClicks) as InlineLinkClicks,
sum(UniqueInlineLinkClicks) as UniqueInlineLinkClicks,
Sum(InlinePostEngagement) as InlinePostEngagement,
Sum(Spend) as Spend,
Sum(SocialSpend) as SocialSpend,
-----s.daily_budget as DailyBudget, 
-----s.lifetime_budget as LifetimeBudget, 
-----s.budget_remaining as BudgetRemaining,
/* these are all caluclated metrics
safe_divide(impressions,reach) as frequency1,
frequency, 
safe_divide(clicks,impressions)*100 as ctr1,
ctr,
safe_divide(unique_clicks,reach)*100 as u_ctr1,
unique_ctr, 
safe_divide(inline_link_clicks,impressions)*100 as in_link_ctr, 
inline_link_click_ctr,
------safe_divide(inline_link_clicks,reach)*100 as u_in_link_ctr,
unique_inline_link_click_ctr, 
safe_divide(unique_inline_link_clicks,reach)*100 as u_in_link_ctr1,
unique_inline_link_click_ctr, 
-----unique_link_clicks_ctr, 
safe_divide(inline_post_engagement,impressions)*100 as inpost_ctr,
*//*
Sum(ActionsComment) as ActionsComment,
Sum(ActionsCompleteRegistration) as ActionsCompleteRegistration, 
Sum(ActionsLandingPageView) as ActionsLandingPageView, 
Sum(ActionsLead) as ActionsLead, 
Sum(ActionsLike) as ActionsLike, 
-------(select sum(value.value) from unnest(actions) as x where value.action_type like '%link_click' ) as actions_link_click, 
Sum(ActionsOffsiteConversionCustom) as ActionsOffsiteConversionCustom, 
Sum(ActionsPageEngagement) as ActionsPageEngagement, 
Sum(ActionsPost) as ActionsPost, 
Sum(ActionsPostEngagement) as ActionsPostEngagement, 
Sum(ActionsPostReaction) as ActionsPostReaction,
Sum(ActionsPostSave) as ActionsPostSave,  
Sum(ActionsViewContent) as ActionsViewContent, 
Sum(ActionsVideoView) as ActionsVideoView, 
Sum(UniqueActionsVideoView) as UniqueActionsVideoView, 
Sum(ActionsVideoWatched_30sec) as ActionsVideoWatched_30sec,
Sum(ActionsVideoWatched_p25) as ActionsVideoWatched_p25,
Sum(ActionsVideoWatched_p50) as ActionsVideoWatched_p50,
Sum(ActionsVideoWatched_p75) as ActionsVideoWatched_p75,
Sum(ActionsVideoWatched_p100) as ActionsVideoWatched_p100,
   
from `crowdriff-revops`.`bi_business`.`facebook_daily_data`

  Group by 
  ----------CalendarWeekStart, 
------CalendarWeekEnd,  
CalendarMonthStart,
CalendarMonthEnd,		
--------------FiscalQuarterStart,			
-------FiscalQuarterEnd,	
--------Calendaryyyymmm,	
---------Replace(Fiscalyyyyq,'_',' ') as Fiscalyyyyq,
--------Fiscalyyyy,
-----CalendarWeeksFromCurrent,
------------CalendarMonthsFromCurrent,
--------------------FiscalQuartersfromCurrent, 
Latest_FB_Day,
Breakdown,
Level1,
Level2,
---------------------CalendarDate, 
CampaignName, 
CampaignId, 
AdsetName, 
AdsetId, 
AdsetStatus, 
AdName, 
AdId, 
Objective, 
CustomEventType
Order by Breakdown,
CalendarMonthEnd,Level2,Level1*/
